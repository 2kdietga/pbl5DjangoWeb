{% extends "base.html" %} {% load static %} {% block content %}

<!-- Top bar -->
<nav class="navbar navbar-light bg-white border-bottom">
  <div class="container d-flex justify-content-between align-items-center">
    <a class="btn btn-link text-dark p-0" href="javascript:history.back()">
      <span class="mr-2">←</span> Quay lại
    </a>
    <span class="text-muted small">Chi tiết vi phạm</span>
  </div>
</nav>

<div class="container py-4">
  <div class="row">
    <!-- Left: Evidence -->
    <div class="col-lg-5 mb-3">
      <div class="card shadow-sm">
        <div
          class="card-header bg-white d-flex justify-content-between align-items-center"
        >
          <strong>Bằng chứng</strong>
        </div>
        <div class="card-body">
          {% if violation.image %}
          <img
            src="{{ violation.image.url }}"
            class="img-fluid rounded border"
            alt="Bằng chứng"
          />
          {% else %}
          <div class="text-center text-muted py-5 border rounded">
            Chưa có hình ảnh / bằng chứng
          </div>
          {% endif %} {% if violation.video_url %}
          <div class="mt-3 small text-muted">
            Nếu link không mở được, hãy kiểm tra quyền truy cập hoặc đường dẫn
            video.
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Right: Details -->
    <div class="col-lg-7">
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <div>
              <h4 class="mb-1">Chi tiết vi phạm</h4>
              <div class="text-muted small">
                Mã: <span class="font-weight-bold">#{{ violation.id }}</span>
              </div>
            </div>

            <span
              class="badge badge-pill px-3 py-2 {% if violation.category.severality_level == 2 %} badge-danger {% else %} badge-secondary {% endif %}"
            >
              {% if violation.category.severality_level == 2 %} Nghiêm trọng
              <!--  -->
              {% else %} Nhắc nhở {% endif %}
            </span>
          </div>

          <hr class="my-3" />

          <!-- Info rows -->
          <div class="mb-2 d-flex">
            <div class="text-muted" style="width: 160px">Tài xế</div>
            <div class="font-weight-bold">
              {{ violation.reporter.get_full_name }}
            </div>
          </div>

          <div class="mb-2 d-flex">
            <div class="text-muted" style="width: 160px">Thời gian</div>
            <div>{{ violation.reported_at }}</div>
          </div>

          <div class="mb-2 d-flex">
            <div class="text-muted" style="width: 160px">Loại lỗi</div>
            <div>{{ violation.category.name }}</div>
          </div>

          <div class="mb-2 d-flex">
            <div class="text-muted" style="width: 160px">Xe</div>
            <div class="font-weight-bold">
              {{ violation.vehicle.license_plate }}
            </div>
          </div>

          <div class="mb-2 d-flex">
            <div class="text-muted" style="width: 160px">Trạng thái</div>
            <div>
              <span class="badge badge-success">Đã xem</span>
            </div>
          </div>

          <div class="mt-3 p-3 bg-light rounded">
            <div class="text-muted small mb-1">Mô tả</div>
            <div
              class="{% if not violation.description %} text-muted {% endif %}"
            >
              {{ violation.description|default:"Không có mô tả" }}
            </div>
          </div>

          <!-- Actions -->
          <div class="mt-4 d-flex justify-content-end">
            <a
              class="btn btn-outline-secondary mr-2"
              href="{% url 'violation_list' %}"
            >
              Đóng
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
